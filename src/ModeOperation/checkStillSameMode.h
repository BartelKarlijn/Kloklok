void checkStillSameMode () {
// check we're still on the same mode.  If not, run appropriate setup before continuing
  if (mode != modeOld) {
    switch (mode)
    {
    case /* constant-expression */:
        /* code */
        break;
    
    default:
        break;
    }
  }
}